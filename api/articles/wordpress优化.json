{"title":"wordpress优化","uid":"b7a0c97312b85aac49e7a436cf1976e7","slug":"wordpress优化","date":"2024-07-30T07:29:37.000Z","updated":"2024-07-30T07:36:07.594Z","comments":true,"path":"api/articles/wordpress优化.json","keywords":null,"cover":null,"content":"<h1 id=\"wordpress主题\"><a href=\"#wordpress主题\" class=\"headerlink\" title=\"wordpress主题\"></a>wordpress主题</h1><h2 id=\"安装主题文件大小受限制\"><a href=\"#安装主题文件大小受限制\" class=\"headerlink\" title=\"安装主题文件大小受限制\"></a>安装主题文件大小受限制</h2><ul>\n<li><p>php.ini</p>\n<p>把 upload_max_filesize 和 post_max_size 修改为20M</p>\n</li>\n<li><p>&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</p>\n<p>client_max_body_size 20m;</p>\n</li>\n</ul>\n<p>上传主题压缩包安装或者选择网上主题进行安装</p>\n<h2 id=\"http自动跳转https\"><a href=\"#http自动跳转https\" class=\"headerlink\" title=\"http自动跳转https\"></a>http自动跳转https</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        listen       [::]:80;</span><br><span class=\"line\">        server_name  star.amshadow.cn;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">        #把http的域名请求转成https</span><br><span class=\"line\">\t\treturn 301 https://$host$request_uri;</span><br><span class=\"line\">\t\t#强制将http的URL重写成https</span><br><span class=\"line\">        #rewrite ^(.*) https://$server_name$1 permanent;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"wordpress插件\"><a href=\"#wordpress插件\" class=\"headerlink\" title=\"wordpress插件\"></a>wordpress插件</h2><h3 id=\"AntiVirus\"><a href=\"#AntiVirus\" class=\"headerlink\" title=\"AntiVirus\"></a>AntiVirus</h3><p>manual Scan </p>\n<h3 id=\"Wordfence安全\"><a href=\"#Wordfence安全\" class=\"headerlink\" title=\"Wordfence安全\"></a>Wordfence安全</h3><p>扫描</p>\n<p>google登录验证</p>\n<h3 id=\"WPS隐藏登录\"><a href=\"#WPS隐藏登录\" class=\"headerlink\" title=\"WPS隐藏登录\"></a>WPS隐藏登录</h3><h3 id=\"WPS-Cleaner\"><a href=\"#WPS-Cleaner\" class=\"headerlink\" title=\"WPS Cleaner\"></a>WPS Cleaner</h3><h3 id=\"WPS-Bidouille\"><a href=\"#WPS-Bidouille\" class=\"headerlink\" title=\"WPS Bidouille\"></a>WPS Bidouille</h3><p><strong>加速插件</strong></p>\n<p>WP Fastest Cache</p>\n<h1 id=\"wordpress主题开发\"><a href=\"#wordpress主题开发\" class=\"headerlink\" title=\"wordpress主题开发\"></a>wordpress主题开发</h1><h2 id=\"文件\"><a href=\"#文件\" class=\"headerlink\" title=\"文件\"></a>文件</h2><p>每个主题至少要有这两个文件 - <strong>style.css</strong> 和 <strong>index.php</strong>。index.php 告诉主题中所有的元素如何布局，style.css 则告诉主题中所有的元素该如何展示，以及它们的样式。下面是一个完整的主题含有的文件列表style.css</p>\n<ul>\n<li>index.php</li>\n<li>home.php</li>\n<li>single.php</li>\n<li>page.php</li>\n<li>archive.php</li>\n<li>category.php</li>\n<li>search.php</li>\n<li>404.php</li>\n<li>comments.php</li>\n<li>comments-popup.php</li>\n<li>author.php</li>\n<li>date.php、</li>\n</ul>\n<h2 id=\"WordPress-专业术语：\"><a href=\"#WordPress-专业术语：\" class=\"headerlink\" title=\"WordPress 专业术语：\"></a>WordPress 专业术语：</h2><ul>\n<li><strong>Template（模板</strong>） — 其实就是一个代码集，主题中很多地方会利用到这个代码集，所以把它们整合成一个模板，这样就就不必一遍遍输入这些重复代码。</li>\n<li><strong>Template file（模板文件</strong>） — 一个包含一个或者多个代码集（模板）文件。每个主题是由多个模板文件组成的，比如：index.php，style.css，sidebar.php 等等。</li>\n<li><strong>Theme（主题</strong>）或者 <strong>WordPress theme（WordPress 主题）</strong> — 所有你正在使用的文件：文本，图像，代码等等。注意： WordPress theme（主题）和 WordPress template(s)（模板）是两个不同的东西，尽管有些人认为他们一样。</li>\n<li><strong>Post（日志或者文章）</strong> — 现在你读的就是一篇日志。此外，它是你 blog 的一个简单的条目，如：一个页面或者一篇日记。</li>\n<li><strong>Page（静态页面）</strong> — 一种特殊的 post，它不是以分类组织的。它有别于你其他的日志。注意：在 WordPress，page（页面）和 Page（静态页面）是两种不同的东西。</li>\n</ul>\n<p>WordPress 博客的<strong>每个页面</strong>是<strong>由多个模板文件组成的</strong>，我们可以看出主题的 <code>index.php</code> 是由 4 个模板文件组成： <code>header.php</code>，<code>index.php</code>，<code>sidebar.php</code> 和 <code>footer.php</code>。</p>\n<h2 id=\"Header-模板文件\"><a href=\"#Header-模板文件\" class=\"headerlink\" title=\"Header 模板文件:\"></a>Header 模板文件:</h2><p>通常在这个文件中包含博客的<strong>标题</strong>（title）和<strong>描述</strong>（description）。而且它们通常在整个博客中都是一样的。</p>\n<h2 id=\"Index-模板文件：\"><a href=\"#Index-模板文件：\" class=\"headerlink\" title=\"Index 模板文件：\"></a>Index 模板文件：</h2><p>这个模板文件包含你的<strong>日志的标题</strong>，<strong>日志的内容</strong>（就是每篇日志的文本和图片）和<strong>日志</strong>的<strong>元数据</strong> （元数据是每篇日志的额外信息，如作者是谁，日志发布的时间，在哪个分类下，有多少留言等等）。</p>\n<h2 id=\"Sidebar-模板文件\"><a href=\"#Sidebar-模板文件\" class=\"headerlink\" title=\"Sidebar 模板文件\"></a>Sidebar 模板文件</h2><p>这个模板文件主要用于控制博客的<strong>页面列表</strong>，<strong>类别列表</strong>，<strong>存档列表</strong>，<strong>友情链接列表</strong>和<strong>其他一些列表</strong>。</p>\n<p><code>footer.php</code> 通常不会因为页面的改变而改变，你可以在这里放置任何东西，但是通常是<strong>版权信息</strong>。</p>\n<p>现在让我解释为什么把上面图片中的 <code>index.php</code> 所在的区域标为红色的。引文这块区域是会根据不同类型的页面而发生变化。</p>\n<p>如果你在单一日志页面，这时候页面将会包含这四个模板文件：<code>header.php</code>，**<code>single.php</code>**，<code>sidebar.php</code> 和 footer。</p>\n<h1 id=\"优化wordpress\"><a href=\"#优化wordpress\" class=\"headerlink\" title=\"优化wordpress\"></a>优化wordpress</h1><p>先通过top看下信息(shift + m 会让进程按照memory排序)<br>发现里面有大量php-fpm进程，经过查找资料发现，php-fpm 的 FastCGI 进程一旦加载就不会释放 。因此有必要先针对这个做一个优化。</p>\n<h2 id=\"php-fpm优化\"><a href=\"#php-fpm优化\" class=\"headerlink\" title=\"php-fpm优化\"></a>php-fpm优化</h2><p>修改php-fpm文件，一般的地址是&#x2F;etc&#x2F;php-fpm.d&#x2F;<a href=\"http://www.conf/\">www.conf</a></p>\n<p>vi &#x2F;etc&#x2F;php-fpm.d&#x2F;<a href=\"http://www.conf/\">www.conf</a></p>\n<p>修改下面这几个参数，找一下就行(参考文末链接1的内容，结果参数含义如下)</p>\n<ul>\n<li>pm：表示使用那种方式，有两个值可以选择，就是static（静态）或者dynamic（动态），默认为dynamic。</li>\n<li>pm.max_children：静态方式下开启的php-fpm进程数量。</li>\n<li>pm.start_servers：动态方式下的起始php-fpm进程数量。</li>\n<li>pm.min_spare_servers：动态方式下的最小php-fpm进程数量。</li>\n<li>pm.max_spare_servers：动态方式下的最大php-fpm进程数量。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">pm = dynamic</span><br><span class=\"line\">pm.max_children = 20</span><br><span class=\"line\">pm.start_servers = 5</span><br><span class=\"line\">pm.min_spare_servers = 2</span><br><span class=\"line\">pm.max_spare_servers = 10</span><br><span class=\"line\">pm.max_requests = 300</span><br></pre></td></tr></table></figure>\n\n<p>保存，之后，重启php-fpm服务</p>\n<p>systemctl restart php-fpm</p>\n<h2 id=\"删除没用的主题\"><a href=\"#删除没用的主题\" class=\"headerlink\" title=\"删除没用的主题\"></a>删除没用的主题</h2><p>删除的方法是就是进入到wordpress的themes目录<br>比如我的是&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;wordpress&#x2F;wp-content&#x2F;themes</p>\n<p>cd &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;wordpress&#x2F;wp-content&#x2F;themes</p>\n<p>然后把theme的文件夹删除就好了， 通过rm</p>\n<h2 id=\"mysql优化\"><a href=\"#mysql优化\" class=\"headerlink\" title=\"mysql优化\"></a>mysql优化</h2><p>超乎寻常的有!!! 但是降低一点打开的速度，一般可以降低50%的内存消耗</p>\n<p>编辑 my.cnf文件<br>vi  my.cnf</p>\n<p>在文末添加下面这一段 (如果你这个文件中已经有了[mysqld]</p>\n<p>[mysqld]<br>performance_schema &#x3D; 0</p>\n<p>重启mysqld服务<br>systemctl restart mysqld</p>\n","text":"wordpress主题安装主题文件大小受限制 php.ini 把 upload_max_filesize 和 post_max_size 修改为20M /etc...","permalink":"/post/wordpress优化","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"开发经验","slug":"开发经验","count":3,"path":"api/categories/开发经验.json"}],"tags":[{"name":"wordpress","slug":"wordpress","count":2,"path":"api/tags/wordpress.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#wordpress%E4%B8%BB%E9%A2%98\"><span class=\"toc-text\">wordpress主题</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%8F%97%E9%99%90%E5%88%B6\"><span class=\"toc-text\">安装主题文件大小受限制</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#http%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%AChttps\"><span class=\"toc-text\">http自动跳转https</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#wordpress%E6%8F%92%E4%BB%B6\"><span class=\"toc-text\">wordpress插件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#AntiVirus\"><span class=\"toc-text\">AntiVirus</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Wordfence%E5%AE%89%E5%85%A8\"><span class=\"toc-text\">Wordfence安全</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#WPS%E9%9A%90%E8%97%8F%E7%99%BB%E5%BD%95\"><span class=\"toc-text\">WPS隐藏登录</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#WPS-Cleaner\"><span class=\"toc-text\">WPS Cleaner</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#WPS-Bidouille\"><span class=\"toc-text\">WPS Bidouille</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#wordpress%E4%B8%BB%E9%A2%98%E5%BC%80%E5%8F%91\"><span class=\"toc-text\">wordpress主题开发</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">文件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#WordPress-%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD%EF%BC%9A\"><span class=\"toc-text\">WordPress 专业术语：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Header-%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">Header 模板文件:</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Index-%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%EF%BC%9A\"><span class=\"toc-text\">Index 模板文件：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Sidebar-%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">Sidebar 模板文件</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BC%98%E5%8C%96wordpress\"><span class=\"toc-text\">优化wordpress</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#php-fpm%E4%BC%98%E5%8C%96\"><span class=\"toc-text\">php-fpm优化</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%A0%E9%99%A4%E6%B2%A1%E7%94%A8%E7%9A%84%E4%B8%BB%E9%A2%98\"><span class=\"toc-text\">删除没用的主题</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#mysql%E4%BC%98%E5%8C%96\"><span class=\"toc-text\">mysql优化</span></a></li></ol></li></ol>","author":{"name":"暗使开开","slug":"blog-author","avatar":"\\favicon.ico","link":"/","description":"<p>即使是虚拟的也会开心</p>唯有终夜长开眼，报以平生未展眉","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/344723412"},"qq":{"icon":"/svg/qq.svg","link":"https://qm.qq.com/q/MXqKNejl6g"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"学习方法","uid":"0f7187f056360c5c434c1ad57a60280d","slug":"学习方法","date":"2024-07-30T07:33:39.000Z","updated":"2024-07-30T07:34:15.544Z","comments":true,"path":"api/articles/学习方法.json","keywords":null,"cover":null,"text":"学习方法费曼学习法：不要浮躁，每个概念都清晰的用笔和纸简短的给别人讲清楚。 ","permalink":"/post/学习方法","photos":[],"count_time":{"symbolsCount":38,"symbolsTime":"1 mins."},"categories":[{"name":"随笔","slug":"随笔","count":1,"path":"api/categories/随笔.json"}],"tags":[{"name":"随笔","slug":"随笔","count":1,"path":"api/tags/随笔.json"}],"author":{"name":"暗使开开","slug":"blog-author","avatar":"\\favicon.ico","link":"/","description":"<p>即使是虚拟的也会开心</p>唯有终夜长开眼，报以平生未展眉","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/344723412"},"qq":{"icon":"/svg/qq.svg","link":"https://qm.qq.com/q/MXqKNejl6g"}}}},"feature":true},"next_post":{"title":"Wordpress-CentOS7","uid":"c25419b8d02da82558175dcb4c4ab39b","slug":"Wordpress","date":"2024-07-30T07:26:13.000Z","updated":"2024-07-30T07:27:51.950Z","comments":true,"path":"api/articles/Wordpress.json","keywords":null,"cover":null,"text":"Wordpress-CentOS7centos7安装wordpress 安装mysql5.7mkdir /opt/mysqlcd /opt/mysqlyum -...","permalink":"/post/Wordpress","photos":[],"count_time":{"symbolsCount":"8.4k","symbolsTime":"8 mins."},"categories":[{"name":"开发经验","slug":"开发经验","count":3,"path":"api/categories/开发经验.json"}],"tags":[{"name":"wordpress","slug":"wordpress","count":2,"path":"api/tags/wordpress.json"}],"author":{"name":"暗使开开","slug":"blog-author","avatar":"\\favicon.ico","link":"/","description":"<p>即使是虚拟的也会开心</p>唯有终夜长开眼，报以平生未展眉","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/344723412"},"qq":{"icon":"/svg/qq.svg","link":"https://qm.qq.com/q/MXqKNejl6g"}}}}}}