{"title":"gitea","uid":"5b5d08436835575fd066ad5ca75118aa","slug":"gitea","date":"2024-07-30T03:50:33.000Z","updated":"2024-08-04T10:28:53.542Z","comments":true,"path":"api/articles/gitea.json","keywords":null,"cover":null,"content":"<h1 id=\"gitea\"><a href=\"#gitea\" class=\"headerlink\" title=\"gitea\"></a>gitea</h1><h2 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysql -uroot -p</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE USER &#x27;gitea&#x27; IDENTIFIED BY &#x27;password&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &#x27;gitea&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;password&#x27; WITH GRANT OPTION;</span><br><span class=\"line\"></span><br><span class=\"line\">CREATE DATABASE giteadb CHARACTER SET &#x27;utf8mb4&#x27; COLLATE &#x27;utf8mb4_unicode_ci&#x27;;</span><br><span class=\"line\"> </span><br><span class=\"line\">GRANT ALL PRIVILEGES ON giteadb.* TO &#x27;gitea&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\"></span><br><span class=\"line\">exit</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装Gitea\"><a href=\"#安装Gitea\" class=\"headerlink\" title=\"安装Gitea\"></a>安装Gitea</h2><p>下载二进制包gitea-1.21.4-linux-amd64</p>\n<p><a href=\"https://dl.gitea.com/gitea/1.21.4/gitea-1.21.4-linux-amd64\">https://dl.gitea.com/gitea/1.21.4/gitea-1.21.4-linux-amd64</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">chmod +x gitea-1.21.4-linux-amd64</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"添加用户\"><a href=\"#添加用户\" class=\"headerlink\" title=\"添加用户\"></a>添加用户</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">groupadd --system git</span><br><span class=\"line\"></span><br><span class=\"line\">adduser \\</span><br><span class=\"line\">   --system \\</span><br><span class=\"line\">   --shell /bin/bash \\</span><br><span class=\"line\">   --comment &#x27;Git Version Control&#x27; \\</span><br><span class=\"line\">   --gid git \\</span><br><span class=\"line\">   --home-dir /home/git \\</span><br><span class=\"line\">   --create-home \\</span><br><span class=\"line\">   git</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建工作路径\"><a href=\"#创建工作路径\" class=\"headerlink\" title=\"创建工作路径\"></a>创建工作路径</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /var/lib/gitea/&#123;custom,data,log&#125;</span><br><span class=\"line\">chown -R git:git /var/lib/gitea/</span><br><span class=\"line\">chmod -R 750 /var/lib/gitea/</span><br><span class=\"line\">mkdir /etc/gitea</span><br><span class=\"line\">chown root:git /etc/gitea</span><br><span class=\"line\">chmod 770 /etc/gitea</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置Gitea工作路径\"><a href=\"#配置Gitea工作路径\" class=\"headerlink\" title=\"配置Gitea工作路径\"></a>配置Gitea工作路径</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">export GITEA_WORK_DIR=/var/lib/gitea/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"复制二进制文件到全局位置\"><a href=\"#复制二进制文件到全局位置\" class=\"headerlink\" title=\"复制二进制文件到全局位置\"></a>复制二进制文件到全局位置</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">cp gitea-1.21.4-linux-amd64 /usr/local/bin/gitea</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"启动Gitea\"><a href=\"#启动Gitea\" class=\"headerlink\" title=\"启动Gitea\"></a>启动Gitea</h3><p>gitea不允许使用root用户运行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">su git</span><br><span class=\"line\"></span><br><span class=\"line\">GITEA_WORK_DIR=/var/lib/gitea/ /usr/local/bin/gitea web -c /etc/gitea/app.ini</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"配置Gitea\"><a href=\"#配置Gitea\" class=\"headerlink\" title=\"配置Gitea\"></a>配置Gitea</h2><p>在浏览器输入IP地址+3000端口，访问Gitea的Web界面</p>\n<p>云服务器安全组端口3000要打开，反向代理后可以关闭</p>\n<h2 id=\"gitea关闭用户注册\"><a href=\"#gitea关闭用户注册\" class=\"headerlink\" title=\"gitea关闭用户注册\"></a>gitea关闭用户注册</h2><p>找到gitea的配置文件gitea&#x2F;conf&#x2F;app.ini，把下面的设置改为true即可:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">ROOT_URL = https://git.eviwbh.com/</span><br><span class=\"line\"></span><br><span class=\"line\">DISABLE_REGISTRATION  = true</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"nginx反向代理\"><a href=\"#nginx反向代理\" class=\"headerlink\" title=\"nginx反向代理\"></a>nginx反向代理</h2><p>上传ssl证书</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       443 ssl http2;</span><br><span class=\"line\">        listen       [::]:443 ssl http2;</span><br><span class=\"line\">    server_name git.eviwbh.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        client_max_body_size 512M;</span><br><span class=\"line\">        proxy_pass http://localhost:3000;</span><br><span class=\"line\">        proxy_set_header Connection $http_connection;</span><br><span class=\"line\">        proxy_set_header Upgrade $http_upgrade;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        #证书文件名称</span><br><span class=\"line\">        ssl_certificate &quot;/etc/nginx/cert/eviwbh_com.pem&quot;;</span><br><span class=\"line\">        #证书私钥文件名称</span><br><span class=\"line\">        ssl_certificate_key &quot;/etc/nginx/cert/eviwbh_com.key&quot;;</span><br><span class=\"line\">        #ssl_session_cache shared:SSL:1m;</span><br><span class=\"line\">        #ssl验证配置</span><br><span class=\"line\">        ssl_session_timeout  10m;</span><br><span class=\"line\">        #配置加密套件/算法加密，写法遵循openssl标准</span><br><span class=\"line\">        ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class=\"line\">        #使用服务器端的首选算法</span><br><span class=\"line\">        ssl_prefer_server_ciphers on;</span><br><span class=\"line\">        #安全链接可选加密协议</span><br><span class=\"line\">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"gitea自启动\"><a href=\"#gitea自启动\" class=\"headerlink\" title=\"gitea自启动\"></a>gitea自启动</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/rc.local</span><br><span class=\"line\"></span><br><span class=\"line\">#gitea</span><br><span class=\"line\">su - git -c &quot;GITEA_WORK_DIR=/var/lib/gitea/ /usr/local/bin/gitea web -c /etc/gitea/app.ini&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">chmod +x /etc/rc.d/rc.local</span><br></pre></td></tr></table></figure>\n\n","text":"gitea数据库mysql -uroot -pCREATE USER 'gitea' IDENTIFIED BY 'password';GRANT ALL PR...","permalink":"/post/gitea","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"开发经验","slug":"开发经验","count":6,"path":"api/categories/开发经验.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#gitea\"><span class=\"toc-text\">gitea</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">数据库</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85Gitea\"><span class=\"toc-text\">安装Gitea</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7\"><span class=\"toc-text\">添加用户</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E8%B7%AF%E5%BE%84\"><span class=\"toc-text\">创建工作路径</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEGitea%E5%B7%A5%E4%BD%9C%E8%B7%AF%E5%BE%84\"><span class=\"toc-text\">配置Gitea工作路径</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A4%8D%E5%88%B6%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%88%B0%E5%85%A8%E5%B1%80%E4%BD%8D%E7%BD%AE\"><span class=\"toc-text\">复制二进制文件到全局位置</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8Gitea\"><span class=\"toc-text\">启动Gitea</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEGitea\"><span class=\"toc-text\">配置Gitea</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#gitea%E5%85%B3%E9%97%AD%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C\"><span class=\"toc-text\">gitea关闭用户注册</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86\"><span class=\"toc-text\">nginx反向代理</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#gitea%E8%87%AA%E5%90%AF%E5%8A%A8\"><span class=\"toc-text\">gitea自启动</span></a></li></ol></li></ol>","author":{"name":"暗使开开","slug":"blog-author","avatar":"\\favicon.ico","link":"/","description":"<p>即使是虚拟的也会开心</p>唯有终夜长开眼，报以平生未展眉","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/344723412"},"qq":{"icon":"/svg/qq.svg","link":"https://qm.qq.com/q/MXqKNejl6g"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"雅思","uid":"487367ff609355e6216873e9408d459b","slug":"雅思","date":"2024-07-30T03:56:53.000Z","updated":"2024-07-30T07:14:44.302Z","comments":true,"path":"api/articles/雅思.json","keywords":null,"cover":null,"text":"IELTS 剑雅真题8-16 考点词538 SIMON雅思课 慎小嶷写作素材库 软件 雅思哥 雅思考满分 每日英语听题 part1 一般加特殊 设置条件，一定要...","permalink":"/post/雅思","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"英语","slug":"英语","count":1,"path":"api/categories/英语.json"}],"tags":[],"author":{"name":"暗使开开","slug":"blog-author","avatar":"\\favicon.ico","link":"/","description":"<p>即使是虚拟的也会开心</p>唯有终夜长开眼，报以平生未展眉","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/344723412"},"qq":{"icon":"/svg/qq.svg","link":"https://qm.qq.com/q/MXqKNejl6g"}}}}},"next_post":{"title":"C++面试题","uid":"222b440dd80fa4c997be1565560f0d77","slug":"cpp面试题","date":"2024-07-30T03:50:33.000Z","updated":"2024-08-04T10:26:49.704Z","comments":true,"path":"api/articles/cpp面试题.json","keywords":null,"cover":[],"text":"C++面试题简述下 C++ 语言的特点 C++ 在 C 语言基础上引入了面对对象的机制，同时也兼容C语言。 C++ 有三大特性（1）封装（2）继承（3）多态。 ...","permalink":"/post/cpp面试题","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"C++","slug":"C","count":3,"path":"api/tags/C.json"}],"author":{"name":"暗使开开","slug":"blog-author","avatar":"\\favicon.ico","link":"/","description":"<p>即使是虚拟的也会开心</p>唯有终夜长开眼，报以平生未展眉","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/344723412"},"qq":{"icon":"/svg/qq.svg","link":"https://qm.qq.com/q/MXqKNejl6g"}}}}}}